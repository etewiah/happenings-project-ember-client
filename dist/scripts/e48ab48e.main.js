!function(){window.HappeningsProjectEmberClient=Ember.Application.create()}(),function(){HappeningsProjectEmberClient.ApplicationRoute=Ember.Route.extend({})}(),function(){HappeningsProjectEmberClient.HappeningRoute=Ember.Route.extend({events:{filterHappenings:function(a,b){a.setEach("cssClass","");var c={};c.city_id=""!==b.city?b.city:HappeningsProjectEmberClient.Happening.currentCity,c.range_id=""!==b.range?b.range:HappeningsProjectEmberClient.Happening.currentRange,b.set("cssClass","active"),this.transitionTo("happening.when",c)}}})}(),function(){HappeningsProjectEmberClient.HappeningWhenRoute=Ember.Route.extend({model:function(a){return a},serialize:function(a){return a},setupController:function(a,b){HappeningsProjectEmberClient.Happening.currentCity=b.city_id,HappeningsProjectEmberClient.Happening.currentRange=b.range_id;var c=HappeningsProjectEmberClient.Happening.getHappenings("today");c.then(function(b){a.set("content",b)})}})}(),function(){HappeningsProjectEmberClient.IndexRoute=Ember.Route.extend({redirect:function(){this.transitionTo("happening.when")}})}(),function(){HappeningsProjectEmberClient.HappeningController=Ember.ArrayController.extend({rangeNavItems:function(){var a=[{title:"today",city:"",range:"today"},{title:"tomorrow",city:"",range:"tomorrow"},{title:"this week",city:"",range:"this_week"},{title:"next week",city:"",range:"next_week"}];return HappeningsProjectEmberClient.NavItem.getNavItems(a)}.property(),cityNavItems:function(){var a=[{title:"Madrid",city:"Madrid",range:""},{title:"Berlin",city:"Berlin",range:""}];return HappeningsProjectEmberClient.NavItem.getNavItems(a)}.property()})}(),function(){HappeningsProjectEmberClient.HappeningWhenController=Ember.ObjectController.extend({})}(),function(){HappeningsProjectEmberClient.Happening=DS.Model.extend({}),HappeningsProjectEmberClient.Happening.reopenClass({currentCity:"Madrid",currentRange:"today",getHappenings:function(){var a="http://happenings-project.herokuapp.com/api/v1/flat_happenings",b={city:HappeningsProjectEmberClient.Happening.currentCity},c=new Date;if("today"===HappeningsProjectEmberClient.Happening.currentRange)b.day_range=c.toISOString();else if("tomorrow"===HappeningsProjectEmberClient.Happening.currentRange){var d=new Date;d.setDate(c.getDate()+1),b.day_range=d.toISOString()}else if("this_week"===HappeningsProjectEmberClient.Happening.currentRange)b.week_range=c.toISOString();else if("next_week"===HappeningsProjectEmberClient.Happening.currentRange){var e=new Date;e.setDate(c.getDate()+7),b.week_range=e.toISOString()}return $.getJSON(a,b).then(function(a){var b=[];return $(a.flat_happenings).each(function(){var a=HappeningsProjectEmberClient.Happening.createRecord({title:this.name,start_date:new Date(this.start_time).toString(),image_url:this.images[0].url,city:this.city});b.push(a)}),b})}})}(),function(){HappeningsProjectEmberClient.NavItem=DS.Model.extend({cssClass:function(){return this.range===HappeningsProjectEmberClient.Happening.currentRange?"active":this.city===HappeningsProjectEmberClient.Happening.currentCity?"active":""}.property()}),HappeningsProjectEmberClient.NavItem.reopenClass({getNavItems:function(a){var b=[];return $(a).each(function(){var a=HappeningsProjectEmberClient.NavItem.createRecord(this);b.push(a)}),b}})}(),function(){HappeningsProjectEmberClient.HappeningView=Ember.View.extend({templateName:"happening"})}(),function(){HappeningsProjectEmberClient.HappeningWhenView=Ember.View.extend({templateName:"happening/when"})}(),function(){HappeningsProjectEmberClient.Router.map(function(){this.resource("happening",{path:"/happening"},function(){this.route("when",{path:"/"}),this.route("when",{path:"/:city_id"}),this.route("when",{path:"/:city_id/:range_id"})})})}(),function(){HappeningsProjectEmberClient.Store=DS.Store.extend({})}();